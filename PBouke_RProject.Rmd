---
title: "What can be learned from speed dating data?"
author: "Team A: Eng Kiat Siah, Jimena Zumaeta, Mehmet Batuhan Ozcan, Marianne Buck, Louis Montagut, Bouke Hylkema"
date: "9/25/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
df <- read.csv("Speed_Dating_Data.csv", header = TRUE)
library(dplyr)
library(ggplot2)
library(knitr)
df <- df[!duplicated(df$iid), ]
```

###Introduction###
In a world where people seek love yet nobody has time, speed-dating seems to be a useful outcome. As people are known to judge the feasibility of a potential romance in a span of mere moments, getting exposure of a few minutes to a large number of people allows for efficient dating. But, are people even aware of what they really want? And do they act upon their perceived preferences? Analysis of speed-dating data provides an insight into the decision-making process of potential lovers, and might be able to provide awareness of key success and failure factors in speed-dating. Ultimately, such analysis may provide for suggestions to date more effectively. 

From 2002-2004 professors of the Columbia Business School analysed speed-daters to evaluate these questions. Respondents were asked to fill out a questionaire in which they were asked to divide 100 points over six attributes of attractiveness, to indicate their perceived importance of each attribute. These attributes are: attractiveness, sincerity, intelligence, fun, ambition, and shared interests. Furthermore, respondents provided details about their demographics, the perceived importance of someone's racial background, their dating frequency, and the goal of participating in speed-dating events. Over the course of time over 550 respondents were monitored.
  Each date lasts for four minutes, after which respondents were able to indicate whether they would match with their date or not. Moreover, each date should be assessed in terms of the six attributes of attractiveness. This allows for comparing people's stated preferences with the characteristics of partners with whom they wanted to match. Four weeks after the dating night, respondents were again asked to distribute 100 points over the six attributes of attractiveness, which provides insight into the development of our preferences as a result of speed-dating. 
  
The further contents of this report detail the findings of an exploratory study towards speed-dating behaviour. The objective has been to identify interesting or remarkable revelations from the dataset. The study was structured by sequentially exploring the data by the hand of the following questions: 
1) What were the characteristics of the set of respondents - in statistics? 
2) What do the respondents look for in their partners, and do differences exist between various demographical groups? 
3) Do people act on their stated preferences during the dating experiments? 
4) How did people follow-up and adapt to the speed-dating night?
5) What lessons can be taken from this analysis? 

##Section 1##
###Chapter 2: Descriptive Statistics### 
The dataset contained information about 552 subjects that formed part of the speed-dating experiment. Each one of them revealed aspects about themselfs before going on the dating rounds. In order to properly analyse the data and the raised hypothesis it is importante to  provide some context about the main  characteristics og the group of subjects.
Therefore the following charts can give an illustrastion about the main profile in the sample uses for this dataset:
1. Age
The proportion of male and female attending the event is proportional, as expected due to the nature of the event.
```{r echo=FALSE, message=FALSE,warning=FALSE}
#Gender
gend <- df["gender"]
#gend_data<- ordered(gend,levels=c(0,1),labels=c("Female","Male"))
#levels=c(0,1)
#labels=c("Female","Male")






ggplot(df,aes(x=factor(1),fill=factor(gender)))+geom_bar(widght=1) +coord_polar("y")


```

2. Race
The pie chart illustrates the representation of races in the group examined. At first glance, it becomes very clear that a very large majorityt of the group is European/Caucasian-American. Furthermore, a around a quarter of the group is Asian/Pacific Islander/Asian-American. Finally, the other race groups have similar proportions amongs them, representing alltogether just under a quarter of the total size of the group.
```{r echo=FALSE, message=FALSE,warning=FALSE}
#Race


ggplot(df)+geom_bar(aes(x=factor(race),fill=factor(race),show.legend=FALSE))+scale_fill_discrete(name="Races",breaks=c("1","2","3","4","5","6"),labels=c("Black/African American","European/Caucasian-American","Latino/Hispanic American","Asian/Pacific Islander/Asian-American","Native American","Other"))

ggplot(df,aes(x=factor(1),fill=factor(race)))+geom_bar(widght=1)+coord_polar("y",start=0)

```
3. Age
The distribution of age of the participants is mainly between 20 and 30. It can be observed that the mean (26.36) is very close to the median (26.0). Thus, the distribution of ages among the participants are evenly divided in most participant cases with the presence of some outliers. 

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Age
ggplot(df)+geom_density(aes(x=age,fill=gender))+ geom_vline(xintercept=26.36, colour="blue")+ geom_vline(xintercept=26.00,)


```

```{r Chapter_2_Descriptive_statistics}
# Clean the data set 
# First clean our preferences data set
columns <- c("attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1", "shar1_1")
elements <- c("attr", "sinc", "intel", "fun", "amb", "shar")
j = 1
totalrow = dim(df)[1]

# summary(df[elements])  #check that the min and max is correct (clean)

while (j <= totalrow) {  #repeat for each row
  totalscore = 0  #compute total score for each row
  for (i in columns){
    totalscore = totalscore + df[j,i]
  }
  for (i in columns){   #compute the normalised score for each elements
    df[j,i] = df[j,i] * 100 / totalscore
  }  
  j = j + 1
}
```

###What do people want?####

The first question that arises when questioning whether (main question) is to consider the preferences of the surveyed population in advance of the speed-dating experiment. The population is segmented based on the charactestics from the previous sections, namely: a) Gender; b) Age; c) Race; d) Dating frequency; e) Goal of dating; and f) the confidence level of participants. The preferences in these segments are evaluated and compared, to see whether there are any interesting differences between the segments. In the next section these insights will be used to evaluate the question whether people actually act on their stated preferences, or whether, generally speaking, people tend to display different behaviour once faced with actual persons.

The first object of interest are the preferences of men and women. 

```{r Gender}
# Prepare data and storage method 
female <- df[ which(df$gender == 0), ]
male <- df[ which(df$gender == 1), ]

Attribute <- c(1:12)
Gender <- c(1:12)
Score <- c(1:12)
mtrx <- data.frame(Gender, Attribute, Score)
mtrx[1:6,2] <- elements
mtrx[7:12,2] <- elements
mtrx[1:6,1] <- 'Female' 
mtrx[7:12,1] <- 'Male' 

# Calculate average values 
for (i in 1:6){
  mtrx[i,3] <- mean(female[,columns[i]], na.rm=TRUE)
  mtrx[i+6,3] <- mean(male[,columns[i]], na.rm=TRUE)
}
kable(mtrx)

# Plot the average attribute values per attribute by race 
ggplot(data = mtrx) + geom_col(aes(x = Attribute, y = Score)) + facet_grid(~ Gender)
```

It seems that there are some interesting differences between men and women. On average, women think the most important trait of a potential partner is intelligence, while deviding points approximately equally amongst attractiveness, sincerity, and fun. Men place very significant importance on looks, giving on average 27 points to this attribute that women gave only 18. Intelligence and fun approximately share second place, while ambition is hardly at all considered important! 

Are there more differences between men and women? Do guys and girls think equally about looking for people from the same race, and are there any differences when the age is considered?

```{r Gender_and_race}
age <- 26
y_female <- female[ which(female$age <= age), ]
o_female <- female[ which(female$age > age), ]
y_male <- male[ which(male$age <= age), ]
o_male <- male[ which(male$age > age), ]

racepref_matrix <- matrix(data = c(1:4), nrow = 2, ncol = 2)
racepref_matrix[1,1] <- mean(y_female$imprace, na.rm = TRUE)
racepref_matrix[2,1] <- mean(o_female$imprace, na.rm = TRUE)
racepref_matrix[1,2] <- mean(y_male$imprace, na.rm = TRUE)
racepref_matrix[2,2] <- mean(o_male$imprace, na.rm = TRUE)
colnames(racepref_matrix) <- c('Female', 'Male')
rownames(racepref_matrix) <- c('Young', 'Old')
kable(racepref_matrix)

par(mfrow=c(1,2))
barplot(racepref_matrix[,1], xlab = "Age", ylab = "Average score in importance of race", main = "Female", ylim = c(0,5))
barplot(racepref_matrix[,2], xlab = "Age", ylab = "Average score in importance of race", main = "Male", ylim = c(0,5))
```

Young females seem to have a relatively much stronger preference for partners of the same race than the rest of the surveyed population, rating this trait with a full point higher on average. 

Looking at the differences in between the older and younger half of the population, it seems that age has little influence on the preferences of people:

```{r Age}
age <- 25
young <- df[ which(df$age < age), ]
old <- df[ which(df$age >= age), ]
# Do people that date frequently have different preferences than people that do not ?
Attribute <- c(1:12)
Age_group <- c(1:12)
Score <- c(1:12)
mtrx <- data.frame(Age_group, Attribute, Score)
mtrx[1:6,2] <- elements
mtrx[7:12,2] <- elements
mtrx[1:6,1] <- 'Young' 
mtrx[7:12,1] <- 'Old' 

for (i in 1:6){
  mtrx[i,3] <- mean(young[,columns[i]], na.rm=TRUE)
  mtrx[i+6,3] <- mean(old[,columns[i]], na.rm=TRUE)
}
kable(mtrx)

# Plot the average attribute values per attribute by race 
ggplot(data = mtrx) + geom_col(aes(x = Attribute, y = Score)) + facet_grid(~ Age_group)
```

Does one's racial background influence their preferences for a certain partner? The next plot displays the average score of each race for each of the attributes, grouped by attribute. In this way it is easy to see which racial background places high or low importance on each of these attributes relative to the other racial backgrounds.

```{r Race_preferences}
# Furthermore, we are interested in the variation in main preferences over race 
# Generate a matrix with the mean values for attribute scores for each race 
race_names <-  c("African", "Caucasian", "Latino", "Asian")
race_att_matrix <- matrix(c(1:24), nrow = 6, ncol = 4)
rownames(race_att_matrix) <- columns
colnames(race_att_matrix) <- race_names

for (y in c(1:4)){
  race_df <- df[ which(df$race == y), ]
  for (i in columns){
    race_att_matrix[i,y] <- mean(race_df[,i], na.rm=TRUE)}
}
print(race_att_matrix)
```
However, to understand how each race evaluates the various attributes against other attributes it is also useful to look at the data in the following way: 

```{r Race_preferences2}
# Plot the average attribute values per attribute by race 
par(mfrow=c(3,2))
for (z in c(1:6)){
  barplot(race_att_matrix[z,], xlab = "Race", ylab = "Average score in attribute", ylim = c(0, 25), main = elements[z])
}

# Plot the average attribute values by attribute per race 
rownames(race_att_matrix) <- elements
par(mfrow=c(2,2))
for (z in c(1:4)){
  barplot(race_att_matrix[,z], xlab = "Attribute", ylab = "Average score in attribute", ylim = c(0, 25), main = race_names[z])
}
```

Caucasian respondents are looking for partners they deem attractive and intelligent. Asians prefer attractive, but sincere partners, while Latinos above all seek intelligence and rank attractiveness second. Africans agree with Caucasians. 

A more sensitive subject may be the influence of someone's race on their choices. How important is it to the respondents that their speed-dating partner has the same racial background? This opinion could be rated on a scale from 1-10. As shown in the boxplot, this seems to be an especially important condition for people with a North-American or European background, while Latinos are more indifferent. 

```{r Race_importance}
y <- df %>% select(race, imprace) %>% filter(race <= 4)
p <- ggplot(data = y) + geom_boxplot(aes(x = race, y = imprace, group = race))
p + scale_x_discrete(name ="Race", limits=c("African", "Caucasian", "Latino", "Asian"))
```

And does the frequency with which people go on a date matter much? We define high dating frequency as all scores from 1:3, and low dating frequency as all scores from 4:7. 

```{r Dating_rate}
# Next plot is dating rate. 
cut_off <- 3
low_date <- df[ which(df$date >= cut_off), ]
high_date <- df[ which(df$date < cut_off), ]
# Do people that date frequently have different preferences than people that do not ?
Attribute <- c(1:12)
Dating_rate <- c(1:12)
Score <- c(1:12)
mtrx <- data.frame(Dating_rate, Attribute, Score)
mtrx[1:6,2] <- elements
mtrx[7:12,2] <- elements
mtrx[1:6,1] <- 'Low_rate' 
mtrx[7:12,1] <- 'High_rate' 

for (i in 1:6){
  mtrx[i,3] <- mean(low_date[,columns[i]], na.rm=TRUE)
  mtrx[i+6,3] <- mean(high_date[,columns[i]], na.rm=TRUE)
}
kable(mtrx)

# Plot the average attribute values per attribute by race 
ggplot(data = mtrx) + geom_col(aes(x = Attribute, y = Score)) + facet_grid(~ Dating_rate)
# 
```

This is interesting! People that date often rate attractiveness a lot higher .. by 8 points! But what is the influence of the purpose of someone's participation? Respondents were asked to state the goal of their participation from the following list:

```{r Serious_relationship}

# Look for preference differences between people who say they are looking for a serious relationship goal = 4, and people who come for a fun night out (goal = 1) or for being able to say they did it (goal = 5)
serious <- df[ which(df$goal == 4), ]
not_serious <- df[ which(df$goal == 1), ]
# Do people that date frequently have different preferences than people that do not ?
serious_matrix <- matrix(c(1:12), nrow = 6, ncol = 2)
rownames(serious_matrix) <- columns
colnames(serious_matrix) <- c("Serious", "Not serious")

for (i in columns){
  serious_matrix[i,1] <- mean(serious[,i], na.rm=TRUE)
  serious_matrix[i,2] <- mean(not_serious[,i], na.rm=TRUE)
}
kable(serious_matrix)
# We do not see significant differences, except for a higher sincerity score of about 3. 
```

Not surprisingly, people that indicate they have a serious purpose with speed-dating are more likely to value sincerity in their partner. It will be interesting to see whether this holds up once they actually make their decisions for matches. 


###Section 2: Do We Know What We Want In Choosing Our Dating Partners?###

###Approach###

We want to evaluate whether people know what they are looking for in choosing a partner.  In another words, we want to compare the responses between what participants gave before the dating event, and what participants chose during the dating event.

Participants are asked what they are looking for in the opposite sex before the dating event.  They evaluated 6 attributes:  attractive ('attr'), sincere ('sinc'), intellent ('intel'), fun ('fun'), ambitious ('amb'), and shared interests ('shar').  

Different waves of participants were asked to rate these 6 attributes in 2 different scoring methodologies:

1.  Distribute 100 points across 6 attributes, giving more points to those attributes they deemed more important in a potential date, and fewer points to these attributes that are less important in a potential date.

2.  Rate the importance of each attribute in a potential date on a scale of 1 to 10 with 1 being not at all important and 10 being extremely important.

In order to do a proper comparison, we normalise all the ratings by getting a Total Score which is the sum of all the scores for all 6 attributes, and multiply each rating by the Normalisation Ratio = 100 / Total Score.

For this evaluation, we examinates 2 sets of attributes:

1.  Scoring before the dating event:  attr1_1, sinc1_1, intel1_1, fun1_1, amb1_1, shar1_1
2.  Scoring after meeting each potential date:  attr, sinc, intel, fun, amb, shar

Scatter plots of each attributes are presented below comparing the scoring before and after meeting each potential date.

In addition, correlation test is done for each attributes to check whether there is any difference between the scoring before and after meeting each potential date.

We investigate the results according to gender and race which the following classifications:

**Gender**

+ Male:  Gender = 1
+ Female:  Gender = 0

**Race**

+ Black/African American: Race = 1
+ European/Caucasian-American: Race = 2
+ Latino/Hispanic American:  Race = 3
+ Asian/Pacific Islander/Asian-American:  Race = 4
+ Native American:  Race = 5
+ Other:  Race = 6

```{r echo=FALSE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)

originset <- read.csv("Speed_Dating_Data.csv", header = TRUE)

elements = c("attr", "sinc", "intel", "fun", "amb", "shar")
j = 1
totalrow = dim(originset)[1]

while (j <= totalrow) {  #repeat for each row
  totalscore = 0  #compute total score for each row
  for (i in elements){
    totalscore = totalscore + originset[j,i]
  }
  for (i in elements){   #compute the normalised score for each elements
    originset[j,i] = originset[j,i] * 100 / totalscore
  }  
  j = j + 1
}

elements = c("attr1_1", "sinc1_1", "intel1_1", "fun1_1", "amb1_1", "shar1_1")
j = 1
totalrow = dim(originset)[1]

while (j <= totalrow) {  #repeat for each row
  totalscore = 0  #compute total score for each row
  for (i in elements){
    totalscore = totalscore + originset[j,i]
  }
  for (i in elements){   #compute the normalised score for each elements
    originset[j,i] = originset[j,i] * 100 / totalscore
  }  
  j = j + 1
}

originset$gender = ifelse(originset$gender==0, "Female", "Male")
```

###Plots, Tests and Analysis of each Attribute by each Gender###

```{r echo = FALSE}
matchedset <- filter(originset, dec==1)
nomatchset <- filter(originset, dec==0)

matchedmale = filter(matchedset, gender=="Male")
matchedfemale = filter(matchedset, gender=="Female")

nomatchmale = filter(nomatchset, gender=="Male")
nomatchfemale = filter(nomatchset, gender=="Female")
```

####1. Ambitious Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match Outcomes**

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=amb1_1, x=amb, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored AMBITIOUS on the scorecard ", y="What people intially said about AMBITIOUS")

ggplot(nomatchset, aes(y=amb1_1, x=amb, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored AMBITIOUS on the scorecard ", y="What people intially said about AMBITIOUS")
```

From the plots and the correlation tests, where there is a match (decision to meet = 1), there is a positive but weak correlationship for the Ambitious (Amb) attribute for both genders, with female placing a higher weightage for Ambitious compared to male.  However, in the plot where there is no match (decision to meet = 0), male showed that they are not meeting those who have lower Ambitious score than what they were looking for but the correlation is weak.  Female is not consistent here as they have rejected those who met their expectation but the correlation is also weak.  Other attributes may have played more strongly in their decisions.

####2. Intelligent Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match (Decision = 0) Outcomes**

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=intel1_1, x=intel, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored INTELLIGENT on the scorecard ", y="What people intially said about INTELLIGENT")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(nomatchset, aes(y=intel1_1, x=intel, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored INTELLIGENT on the scorecard ", y="What people intially said about INTELLIGENT")
```

From the correlation tests and scatter plots for Intelligent attribute (Intel), we can see that all the lines are almost horizontal, meaning there is no correlation between what people wanted and what people chose.  This could mean that people did not put much weight in intelligent attribute in choosing their dates.

####3. Shared Interest Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match (Decision = 0) Outcomes**

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=shar1_1, x=shar, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored SHARED INTERESTS on the scorecard ", y="What people intially said about SHARED INTERESTS")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(nomatchset, aes(y=shar1_1, x=shar, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored SHARED INTERESTS on the scorecard ", y="What people intially said about SHARED INTERESTS")
```

From the scatter plots, we see that there is a moderate correlationship for Shared Interests (Shar) attribute for female participants in choosing their dating partners.  There is no correlationship for Shared Interest attribute for male participants.  Neither is there any correlationship for both male and female participants in not choosing their dating partners based on Shared Interest attribute. 

####4. Fun Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match (Decision = 0) Outcomes**

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=fun1_1, x=fun, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored FUN on the scorecard ", y="What people intially said about FUN")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(nomatchset, aes(y=fun1_1, x=fun, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored FUN on the scorecard ", y="What people intially said about FUN")
```

From the correlation tests and scatter plots, both genders showed that there is a positive but very weak correlationship between what they wanted their partners to be fun and what they eventually chose.  Similarly, there is a weak negative correlationship in deciding not to meet a potential date.  In another words, both genders showed that they are rather consistent, thought weak, in their choice of a potential date when the other party meets their desired level of being fun.

####5. Attractive Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match (Decision = 0) Outcomes**

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=attr1_1, x=attr, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored ATTRACTIVE on the scorecard ", y="What people intially said about ATTRACTIVE")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(nomatchset, aes(y=attr1_1, x=attr, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored ATTRACTIVE on the scorecard ", y="What people intially said about ATTRACTIVE")
```

When comes to being attractive, male participants are rather consistent in chosing someone being attractive and rejecting someone being less attractive than what they have preferred but the correlationship is weak.  However, famale participants are less concerned about their partner being attractive as there is almost zero correlationship showed by the relatively flat lines for both accepting or rejecting someone. 

####6. Sincere Attribute####

**Plots of Attribute Scored by Participants for Matched (Decision = 1) and No Match (Decision = 0) Outcomes**

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=sinc1_1, x=sinc, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored SINCERE on the scorecard ", y="What people intially said about SINCERE")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(nomatchset, aes(y=sinc1_1, x=sinc, color = factor(gender)))+
  geom_point()+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored SINCERE on the scorecard ", y="What people intially said about SINCERE")
```

Male participants have shown slight positive correlationship in their preferance and their final choice of date for those they perceived to be sincere.  Surprisingly, females are relatively indifference in their decisions based on sincerity.

###Linear Modelling of Decision###

**Linear Model for Decision by Male Participants**
```{r echo = FALSE, warning=FALSE, message=FALSE}
maleset <- filter(originset, gender=="Male")
femaleset <- filter(originset, gender=="Female")
m <- lm(formula = dec ~ fun + attr + shar, data = maleset)
summary(m)
```

**Linear Model for Decision by Female Participants**
```{r echo = FALSE, warning=FALSE, message=FALSE}
f <- lm(formula = dec ~ fun + attr + shar, data = femaleset)
summary(f)
```

We attempt to create a model for the decision taken by male and female participants respectively.  After removing attributes with high p-values, we are left with Fun, Attractive and Shared Interest attributes for both male and female paricipants.  However, the adjusted R-square of both models are low.  There may be other variables that determine the final decision for choosing someone to date.  We could carry out further analysis of the self-preception score and check how the relative score of the potential date may affect the choice and create a better model for decision.

###Plots and Analysis of each Attribute by each Race###

####1. Ambitious Attribute####
```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=amb1_1, x=amb, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm',size = 1)+labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about AMBITION")

ggplot(nomatchset, aes(y=amb1_1, x=amb, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm',size = 1)+
  labs(title="People who said 'NO' to meeting again", x="What people actually scored AMBITION on the scorecard ", y="What people intially said about AMBITION")
```

The axes have been drawn in a way that how participants initially rate the importance of the following attributes in a potential date on a scale of 100 is on the vertical axis and  what the participants actually scored for their partners during the meeting is on the horizontal axis.

In this part of the report,consistency of the answers based on the different races is going to be examined.

Valuation of ambition attribute among the participants who would like to meet the person they are talking to again is parallel with what they had stated before.As it can clearly be seen that all the lines are having a positive gradiant,in this case it is possible to say that all races more or less sticked with their initial opinion on the importance of ambition attribute and thus,a positive correlation exists for those who said yes.On the other hand,the participants who rejected the contacted-person show a different pattern than those who said yes to their partners.When the green line examined,namely Latino/Hispanic Americans,it is interesting to see that even if there is a strong correlation for the importance of ambition level in their selection decisions,still they did not the chose the person they are in touch based on thier ambition score.It may be concluded that the other factors played a greater role in their choice.The same can be said for the rest of the races hovewer, the inconsistance level on what they said but they acted otherwise is less for other the other races.Overall, ambition parameter played a more significant role among the "YESSERS!" than it played among "NOERS!"

####2. Intelligent Attribute####
```{r echo = FALSE, warning=FALSE, message=FALSE}

ggplot(matchedset, aes(y=intel1_1, x=intel, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+
  labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about INTELLEGENCE")
  

ggplot(nomatchset, aes(y=intel1_1, x=intel, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'NO' to meeting again", x="What people actually scored INTELLEGENCE on the scorecard ", y="What people intially said about INTELLEGENCE")

```

When it comes to the intelligence attribute among the participants who said "YES"",it is being observed that overall, the results are approximately in a form of straight line, with a positive gradient. We therefore say that there is a positive but weak correlation within Asian/Pacific Islander Americans,blue line,and Latino/Hispanic Americans with respect to what they scored on the scorebord card.On contrast,Black Americans,red line,experienced a negative gradient which corresponds to a negative correlation.That may lead us to a conclusion that even though Black Americans did not assign a high value for intelligence parameter in the beginning,during the meeting they choosed the one with a higher intelligence capacity.For participants who said "NO", there is not a strong correlation with their choice and scorings.

####3. Shared Interest Attribute####
```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=shar1_1, x=shar, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about SHARED INTEREST")

ggplot(nomatchset, aes(y=shar1_1, x=shar, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'NO' to meeting again", x="What people actually scored SHARED INTEREST on the scorecard ", y="What people intially said about SHARED INTEREST")
```

Looking at the graph of shared interest attribute,for all the races but the Asian/Pacific Islander Americans,it can be observed that there is a strong positive correlation with their intial and scored bored evaluation.This help us draw the conclusion of shared interest played a signficant role in partner selection.Among people who refused their partner,it is interesting that although there is a strong corretaion among Latino's scorings,they still refused ther partner.

####4. Fun Attribute####

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=fun1_1, x=fun, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about FUN ")

ggplot(nomatchset, aes(y=fun1_1, x=fun, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'NO' to meeting again", x="What people actually scored FUN on the scorecard ", y="What people intially said about FUN")
```

According the plot,while having a negative correlation on Fun parameter, all the races except Asian/Pacific Islander Americans agreed on going out with their partners.What can be concluded is that Fun attribute does not a play an important role in partner selection for all those races with the negative correlation.However,for those from Asian/Pacific Islander Americans race,the decison they made looks consistent with how they scored their partners.

####5. Attractive Attribute####

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=attr1_1, x=attr, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+
 labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about ATTRACTIVENESS")

ggplot(nomatchset, aes(y=attr1_1, x=attr, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'NO' to meeting again", x="What people actually scored ATTRACTIVENESS on the scorecard ", y="What people intially said about ATTRACTIVENESS")
```
Even if it is being thought as one of the most important parameters in partner selection,it is suprising that attractivess attribute has a week positive correlation gradient among the participants from different ethnicity when choosing a partner.On contrast,when refusing, it gains a slightly more importance.Thus,not while choosing but while refusing attracttivess matters for people.

####6. Sincere Attribute####

```{r echo = FALSE, warning=FALSE, message=FALSE}
ggplot(matchedset, aes(y=sinc1_1, x=sinc, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'YES' to meeting again", x="What people actually scored on the scorecard ", y="What people intially said about SINCERITY")

ggplot(nomatchset, aes(y=sinc1_1, x=sinc, color = factor(race)))+
  geom_point(pch=5)+
  geom_smooth(method = 'lm')+labs(title="People who said 'NO' to meeting again", x="What people actually scored SINCERITY on the scorecard ", y="What people intially said about SINCERITY")
```

Last but not least,while it possible to mention a weak positive correlation on sincerity attribute for Asian/Pacific Islander Americans,Europen-Caucasion and Latino Americans,there is a relatively strong negative correlation for the remaining two nations.What we can understand from this result that,even if at the beginning sincerity was not among the the most important parameters in partner selection,in the end for those with negative correlation it played an important role.

###Linear Modelling of Decision###

```{r echo = FALSE, warning=FALSE, message=FALSE}
Blck_Afr_American <- filter(originset, race=="1")
Eurpn_Cauc_American <- filter(originset, race=="2")
Latno_Hspanc_American<- filter(originset, race=="3")
Asn_Pacific_American<- filter(originset, race=="4")
Other<- filter(originset, race=="6")
```

**Linear Model for Decision by Black/African Americans**
```{r echo = FALSE, warning=FALSE, message=FALSE}
m1 <- lm(formula = dec ~ attr + shar+intel, data = Blck_Afr_American)
summary(m1)
```

**Linear Model for Decision by European/Caucasian-Americans**

```{r echo = FALSE, warning=FALSE, message=FALSE}
m2 <- lm(formula = dec ~ fun + attr + shar, data =Eurpn_Cauc_American)
summary(m2)
```

**Linear Model for Decision by Latino/Hispanic American**

```{r echo = FALSE, warning=FALSE, message=FALSE}
m3 <- lm(formula = dec ~ fun + attr + shar+sinc, data =Latno_Hspanc_American)
summary(m3)
```
**Linear Model for Decision by Asian/Pacific Islander/Asian-American**

```{r echo = FALSE, warning=FALSE, message=FALSE}
m4 <- lm(formula = dec ~ fun + attr + shar, data =Asn_Pacific_American)
summary(m4)
```
**Linear Model for Decision by Other**

```{r echo = FALSE, warning=FALSE, message=FALSE}
m5 <- lm(formula = dec ~ fun + attr + shar, data =Other)
summary(m5)
```

According to the results obtained by running linear regression  for each race on different attributes,being fun,attractive and having shared interests play a more significant role in partner selection compare to the other attributes withing all the races except the Black African Americans where intelligence replaces the "fun" attribute.


**Part Louis and Marianne**
```{r Chapter_4: Normalization and dataset set up}
knitr::opts_chunk$set(echo = TRUE)

# Setting up customized datasets

originset <- read.csv("Speed_Dating_Data.csv", header = TRUE)
summary(originset)

elements_2 = c("attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2", "shar1_2")
elements_3 = c("attr1_3", "sinc1_3", "intel1_3", "fun1_3", "amb1_3", "shar1_3")
j = 1
totalrow = dim(originset)[1]

summary(originset[elements_2])  #check that the min and max is correct (clean)
summary(originset[elements_3])  #check that the min and max is correct (clean)

# Let's normalize the variables as scoring vary for some waves
while (j <= totalrow) {  #repeat for each row
  totalscore = 0  #compute total score for each row
  for (i in elements_2){
    totalscore = totalscore + originset[j,i]
  }
  for (i in elements_2){   #compute the normalised score for each elements
    originset[j,i] = originset[j,i] * 100 / totalscore
  }
  for (k in elements_3){
    totalscore = totalscore + originset[j,k]
  }
  for (k in elements_3){   #compute the normalised score for each elements
    originset[j,i] = originset[j,k] * 100 / totalscore
  }  
  j = j + 1
}

# We can create now a proper dataset for our Question 4

Q4_df <- originset[, c("gender", "samerace", "income", "attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2", "shar1_2", "attr1_3", "sinc1_3", "intel1_3", "fun1_3", "amb1_3", "shar1_3", "date_3")]

Q4_df <- na.omit(Q4_df)

# Eventually, let's split our new dataset in 2 parts: people who dated (yes) vs. those who didn't (no)
Q4_df_yes <- subset(Q4_df, date_3 == "1")
Q4_df_yes <- na.omit(Q4_df_yes) #removes NA

Q4_df_no <- subset(Q4_df, date_3 == "0")
Q4_df_no <- na.omit(Q4_df_no) #removes NA

```
```{r Chapter_4: Preliminary analysis}

# Let's see how men and women weight each criteria right after speed dating 
library(ggplot2)

#Attractiveness: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = attr1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
  scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Attractiveness", title = "Attractiveness criteria after speed-dating: men vs. women")

#Intelligence: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = intel1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
    scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Intelligence", title = "Intelligence criteria after speed-dating: men vs. women")

#Ambition: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = amb1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
    scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Ambition", title = "Ambition criteria after speed-dating: men vs. women")

#Fun: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = fun1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
    scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Fun", title = "Fun criteria after speed-dating: men vs. women")

#Shared Interests: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = shar1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
    scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Shared Interests", title = "Shared Interests criteria after speed-dating: men vs. women")

#Sincerity: how is it weighted right after speed-dating for men vs. women
ggplot(Q4_df, aes(x = factor(gender), y = sinc1_2, fill = factor(gender))) +
  geom_boxplot() +
  scale_fill_hue(l=60, c=40) +
    scale_y_continuous(limits = c(0,100)) +
  labs(x = "Gender", y = "Sincerity", title = "Sincerity criteria after speed-dating: men vs. women")

cat("Right after the speed-dating, when asked about what they look for in the opposite sex:\
- Men and women gave similar results for Intelligence, Fun, Sincerity and Shared Interests \
- But significant differences remained for Attractiveness and Ambition \
  
Indeed, for Attractiveness, the 25% most demanding men gave at least a 35/100 grade for \ attractiveness vs. 25/100 for women.
  
Something even more striking is that 25% of men gave a 0/100 grade for ambition after the\ speed-dating experience")

```



```{r Chapter_4: Hypothesis}

# Hypothesis: Dating changes the preferences of people?


```

Now we will examine if what people want remains consistent over a longer period of time.

For this our Hypothesis is that what you look for in the opposite sex doesn't change over time depending on if you went on dates or not.

```{r Chapter_4: Normalize columns and prepare data needed for analysis}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(dplyr)
#What do you look for in the opposite sex - right after speed-dating
# Column names: attr1_2 sinc1_2 intel 1_2 fun1_2 amb1_2 shar1_2 

#What do you look for in the opposite sex - after possible dating (4 weeks later)
# Column names: attr1_3 sinc1_3 intel1_3 fun1_3 amb1_3 shar1_3 

#normalize above columns
originset <- read.csv("Speed_Dating_Data.csv", header = TRUE)
summary(originset)

elements_2 = c("attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2", "shar1_2")
elements_3 = c("attr1_3", "sinc1_3", "intel1_3", "fun1_3", "amb1_3", "shar1_3")
j = 1
totalrow = dim(originset)[1]

summary(originset[elements_2])  #check that the min and max is correct (clean)
summary(originset[elements_3])  #check that the min and max is correct (clean)

while (j <= totalrow) {  #repeat for each row
  totalscore = 0  #compute total score for each row
  for (i in elements_2){
    totalscore = totalscore + originset[j,i]
  }
  for (i in elements_2){   #compute the normalised score for each elements
    originset[j,i] = originset[j,i] * 100 / totalscore
  }
  for (k in elements_3){
    totalscore = totalscore + originset[j,k]
  }
  for (k in elements_3){   #compute the normalised score for each elements
    originset[j,i] = originset[j,k] * 100 / totalscore
  }  
  j = j + 1
}

# creating dataset with relevant columns

Q4_df <- originset[, c("gender", "attr1_2", "sinc1_2", "intel1_2", "fun1_2", "amb1_2", "shar1_2", "attr1_3", "sinc1_3", "intel1_3", "fun1_3", "amb1_3", "shar1_3", "date_3")]


# Have you been on a date with any of your matches?
# Variable: date_3 Yes=1, No=0

#limit one dataset to Yes=1 and one to No=0
Q4_df_yes <- subset(Q4_df, date_3 == "1")
Q4_df_no <- subset(Q4_df, date_3 == "0")


```

For this we use a T-Test to check, wether the means for both data sets of people who went to dates and people who didn't go on dates are the same before the 4 weeks period. 
We find that our T-Test confirms same means for the attributes of attractiveness, fun and sincerity.
For shared interests, ambition and intelligence, the mean of the two subsets of people who went to dates and those who didn't is not the same to begin with.

When conducting a T-Test for the means of the different attributes after 4 weeks, depending on wether someone has dated or not, we find that the means are now different for intelligence (vs. the same before) and the same for fun (vs. different before).
This shows that overall the mean for what we look for in the opposite sex have been influenced by dating for the attributes of intelligence and a fun personality.

```{r Chapter_4: T-Test for attributes over time}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)

#two sided means that the sample mean is different from 0 (checking on both sides of 0)
#if I get a p-value below 0.05, I reject the 0 hypothesis - meaning that the means are different
#if I get a p-value above 0.05, I fail to reject the 0 hypothesis 

#starting values: not different for sinc, fun and attr - different for: shar,amb and intel
t.test(Q4_df_yes$attr1_2,Q4_df_no$attr1_2,alternative = "two.sided")
t.test(Q4_df_yes$fun1_2,Q4_df_no$fun1_2,alternative = "two.sided")
t.test(Q4_df_yes$shar1_2,Q4_df_no$shar1_2,alternative = "two.sided")
t.test(Q4_df_yes$amb1_2,Q4_df_no$amb1_2,alternative = "two.sided")
t.test(Q4_df_yes$sinc1_2,Q4_df_no$sinc1_2,alternative = "two.sided")
t.test(Q4_df_yes$intel1_2,Q4_df_no$intel1_2,alternative = "two.sided")


#same means: attr,sinc, intel - means are different for: pos: fun,shar neg:amb
#since we only had same means to begin with for sinc, fun and attr, there are only changes in intel and fun

t.test(Q4_df_yes$attr1_3,Q4_df_no$attr1_3,alternative = "two.sided")
t.test(Q4_df_yes$fun1_3,Q4_df_no$fun1_3,alternative = "two.sided")
t.test(Q4_df_yes$shar1_3,Q4_df_no$shar1_3,alternative = "two.sided")
t.test(Q4_df_yes$amb1_3,Q4_df_no$amb1_3,alternative = "two.sided")
t.test(Q4_df_yes$sinc1_3,Q4_df_no$sinc1_3,alternative = "two.sided")
t.test(Q4_df_yes$intel1_3,Q4_df_no$intel1_3,alternative = "two.sided")


```



By plotting the data, we can see that people who have gone on dates tend to value intelligence less and a fun personality more than people who didn't go on dates within the 4 week period.


```{r Chapter_4: Plotting the affected attributes}
knitr::opts_chunk$set(echo = TRUE)



#for those going on a date: importance of intelligence decreases and importance of fun increases if you went on a date
ggplot(Q4_df,aes(x=fun1_2,y=fun1_3,colour=factor(date_3)))+geom_point(alpha=0.1)+
  geom_smooth(data=Q4_df_no, aes(x=fun1_2, y=fun1_3), color='#FD5A31')+
  geom_smooth(data=Q4_df_yes, aes(x=fun1_2, y=fun1_3), color='#4FCDE1')+
  labs(title = "How important is a fun personality to you?", x = "After speeddating", y = "Four weeks later")+
  scale_colour_discrete(name  ="Dating",
                        breaks=c("0", "1"),
                        labels=c("Have not dated", "Have dated"))


ggplot(Q4_df,aes(x=intel1_2,y=intel1_3,colour=factor(date_3)))+geom_point(alpha=0.1)+
  geom_smooth(data=Q4_df_no, aes(x=intel1_2, y=intel1_3), color='#FD5A31')+
  geom_smooth(data=Q4_df_yes, aes(x=intel1_2, y=intel1_3), color='#4FCDE1')+
  labs(title = "How important is intelligence to you?", x = "After speeddating", y = "Four weeks later")+
  scale_colour_discrete(name  ="Dating",
                        breaks=c("0", "1"),
                        labels=c("Have not dated", "Have dated"))

```
Looking at this, we can take away from it what we knew all along - that the most important thing when dating is having fun while doing it. We can conclude from the data, that dating might help us reflect on what we really look for in the other gender and therefore help bring us closer to understand what we really want.

Let's now also look at how this varies for the different genders.


```{r Q4 Tests of means for Intelligence}

#Compute means of Intelligence criteria for men and women who dated and didn't at:
# time2 = right after speed-dating
# time3 = 4 weeks later

intel_no_men_before <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_2" ]
intel_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_3" ]

intel_yes_men_before <- Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_2" ]
intel_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_3" ]

mean1 <- mean(intel_no_men_before <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_2" ])
mean2 <- mean(intel_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_3" ])

mean3 <- mean(intel_no_men_before <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_2" ])
mean4 <- mean(Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_3" ])


# Test if the Average Intelligence Score given by men differ, whether they date or not
intel_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_3" ]
intel_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_3" ]
t.test(intel_no_men_after, intel_yes_men_after)

# Test if the Average Intelligence Score given by women differ, whether they date or not
intel_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "intel1_3" ]
intel_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "intel1_3" ]
t.test(intel_no_women_after, intel_yes_women_after)

# How the Average Intelligence Score given by men changes, for those who haven't date
intel_no_men_before <- Q4_df_no[(Q4_df_no$gender == "1"), "intel1_2" ]
intel_no_men_after <- Q4_df_no[(Q4_df_yes$gender == "1"), "intel1_3" ]
t.test(intel_no_men_before, intel_no_men_after)

# How the Average Intelligence Score given by men changes, for those who haven't date
intel_yes_men_before <- Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_2" ]
intel_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "intel1_3" ]
t.test(intel_yes_men_before, intel_yes_men_after)


```


```{r Q4 Tests of means for Attractiveness}

# Test if the Average Attractivenes Score given by men differ, whether they date or not
attr_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "attr1_3" ]
attr_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "attr1_3" ]
t.test(attr_no_men_after, attr_yes_men_after)

# Test if the Average Attractivenes Score given by women differ, whether they date or not
attr_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "attr1_3" ]
attr_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "attr1_3" ]
t.test(attr_no_women_after, attr_yes_women_after)


```


```{r Tests of means for Fun}

# Test if the Average Fun Score given by men differ, whether they date or not
fun_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "fun1_3" ]
fun_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "fun1_3" ]
t.test(fun_no_men_after, fun_yes_men_after)

# Test if the Average Fun Score given by women differ, whether they date or not
fun_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "fun1_3" ]
fun_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "fun1_3" ]
t.test(fun_no_women_after, fun_yes_women_after)

```


```{r Tests of means for Ambition}

# Test if the Average Ambition Score given by men differ, whether they date or not
amb_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "amb1_3" ]
amb_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "amb1_3" ]
t.test(amb_no_men_after, amb_yes_men_after)

# Test if the Average Ambition Score given by women differ, whether they date or not
amb_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "amb1_3" ]
amb_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "amb1_3" ]
t.test(amb_no_women_after, amb_yes_women_after)



```


```{r Tests of means for Sincerity}

# Test if the Average Sincerity Score given by men differ, whether they date or not
sinc_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "sinc1_3" ]
sinc_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "sinc1_3" ]
t.test(sinc_no_men_after, sinc_yes_men_after)

# Test if the Average Sincerity Score given by women differ, whether they date or not
sinc_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "sinc1_3" ]
sinc_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "sinc1_3" ]
t.test(sinc_no_women_after, sinc_yes_women_after)

```



```{r Tests of means for Shared Interests}

# Test if the Average Shared Interests Score given by men differ, whether they date or not
shar_no_men_after <- Q4_df_no[(Q4_df_no$gender == "1"), "shar1_3" ]
shar_yes_men_after <- Q4_df_yes[(Q4_df_yes$gender == "1"), "shar1_3" ]
t.test(shar_no_men_after, shar_yes_men_after)

# Test if the Average Shared Interests Score given by women differ, whether they date or not
shar_no_women_after <- Q4_df_no[(Q4_df_no$gender == "0"), "shar1_3" ]
shar_yes_women_after <- Q4_df_yes[(Q4_df_yes$gender == "0"), "shar1_3" ]
t.test(shar_no_women_after, shar_yes_women_after)

```




```{r Attractiveness Criteria Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the attractiveness criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

attr_yes <- ggplot(Q4_df_yes, aes(x = attr1_2, y = attr1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the attractiveness criteria for people who dated")

attr_no <- ggplot(Q4_df_no, aes(x = attr1_2, y = attr1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the attractiveness criteria for people who didn't date")

attr_yes
attr_no

```

```{r Intelligence Analysis Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the intelligence criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

intel_yes <- ggplot(Q4_df_yes, aes(x = intel1_2, y = intel1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the intelligence criteria for people who dated")

intel_no <- ggplot(Q4_df_no, aes(x = intel1_2, y = intel1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the intelligence criteria for people who didn't date")

intel_yes
intel_no

```

```{r Sincerity Analysis Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the sincerity criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

sinc_yes <- ggplot(Q4_df_yes, aes(x = sinc1_2, y = sinc1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the sincerity criteria for people who dated")

sinc_no <- ggplot(Q4_df_no, aes(x = sinc1_2, y = sinc1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the sincerity criteria for people who didn't date")

sinc_yes
sinc_no


```


```{r Fun Analysis Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the fun criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

fun_yes <- ggplot(Q4_df_yes, aes(x = fun1_2, y = fun1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the fun criteria for people who dated")

fun_no <- ggplot(Q4_df_no, aes(x = fun1_2, y = fun1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the fun criteria for people who didn't date")

fun_yes
fun_no

```


```{r Ambition Analysis Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the ambition criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

amb_yes <- ggplot(Q4_df_yes, aes(x = amb1_2, y = amb1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the ambition criteria for people who dated")

amb_no <- ggplot(Q4_df_no, aes(x = amb1_2, y = amb1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the sincerity ambition for people who didn't date")

amb_yes
amb_no

```


```{r Shared Interests Analysis Q4 Louis}

library(ggplot2)

#Let's plot the evolution of the shared interests criteria function of the gender and:
#   - if people dated 4 weeks later
#   - if people didn't date 4 weeks later

shar_yes <- ggplot(Q4_df_yes, aes(x = shar1_2, y = shar1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the ambition criteria for people who dated")

shar_no <- ggplot(Q4_df_no, aes(x = shar1_2, y = shar1_3, col = factor(gender))) + 
    geom_point() + 
    geom_smooth(method = "lm") + 
    labs(col = "Gender") +
  ggtitle("Evolution of the sincerity ambition for people who didn't date")

shar_yes
shar_no

```



``` {r}
